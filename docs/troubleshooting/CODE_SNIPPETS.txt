KEY CODE SNIPPETS FROM LIGHTRAG REPOSITORY
===========================================

1. EMPTY QUERY HANDLING - lightrag/lightrag.py (Commit 29bac49f)

if query_result is None:
    final_data = {
        "status": "failure",
        "message": "Query returned no results",
        "metadata": {
            "failure_reason": "no_results",
            "mode": data_param.mode
        }
    }

2. CONTEXT BUILDING WITH EMPTY CHECK - lightrag/operate.py (Commit 4ce823b4)

if not search_result["final_entities"] and not search_result["final_relations"]:
    if query_param.mode \!= "mix":
        return None
    else:
        if not search_result["chunk_tracking"]:
            return None

3. DEFAULT CONSTANTS - lightrag/constants.py

DEFAULT_SUMMARY_MAX_TOKENS = 1200
DEFAULT_SUMMARY_LENGTH_RECOMMENDED = 600
DEFAULT_SUMMARY_CONTEXT_SIZE = 12000
DEFAULT_TOP_K = 40
DEFAULT_CHUNK_TOP_K = 20
DEFAULT_MAX_ENTITY_TOKENS = 6000
DEFAULT_MAX_RELATION_TOKENS = 8000
DEFAULT_MAX_TOTAL_TOKENS = 30000
DEFAULT_COSINE_THRESHOLD = 0.2

4. OLLAMA INITIALIZATION - lightrag/llm/ollama.py

ollama_client = ollama.AsyncClient(
    host=host,
    timeout=timeout,
    headers=headers
)
response = await ollama_client.chat(
    model=model,
    messages=messages,
    **kwargs
)

5. EMBEDDING FUNCTION - lightrag/llm/ollama.py

data = await ollama_client.embed(
    model=embed_model,
    input=texts,
    options=options
)
return np.array(data["embeddings"])

